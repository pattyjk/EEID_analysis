#plot it yo
ggplot(br.coords, aes(MDS1, MDS2, colour=species_capture, shape=region_id))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
ggplot(pa.coords, aes(MDS1, MDS2, colour=region_id, shape=species_capture))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
ggplot(pa.coords, aes(MDS1, MDS2, colour=month, shape=species_capture))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
ggplot(pa.coords, aes(MDS1, MDS2, colour=Month, shape=species_capture))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endospore_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
View(meta)
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species))+
geom_point(aes(size=2))+
geom_text()+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Type))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endospore_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#5.5
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Type))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
View(s16.coords)
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Type, shape=Species))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Type, shape=Species, label=SampleID))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Type, shape=Species, label=SampleID))+
geom_point(aes(size=2))+
theme_bw()+
geom_text()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
dim(s16.coords)
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endospore_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#5.5
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Quadrant, shape=Species, label=SampleID))+
geom_point(aes(size=2))+
theme_bw()+
geom_text()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endospore_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#5.5
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Quadrant, shape=Species, label=SampleID))+
geom_point(aes(size=2))+
theme_bw()+
geom_text()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endospore_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#5.5
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Quadrant, shape=Species, label=SampleID))+
geom_point(aes(size=2))+
theme_bw()+
geom_text()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
names(meta)
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endospore_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#5.5
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species, shape=Nuc_type, label=SampleID))+
geom_point(aes(size=2))+
theme_bw()+
geom_text()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endospore_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#5.5
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species, shape=Nuc_type))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
View(s16.coords)
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endo_asv_table.txt", row.names=1)
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endo_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#9.2
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#5.5
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species, shape=Nuc_type))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endo_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
otu_table_t<-t(otu_table)
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#10.8
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species, shape=Nuc_type))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endo_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#10.8
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#7.9
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species, shape=Nuc_type))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
otu_table <- read.delim("C:/Users/patty/OneDrive/Desktop/endo_asv_table.txt", row.names=1)
meta<-read.delim("C:/Users/patty/OneDrive/Desktop/endospore_map.txt", header=T)
library(vegan)
library(ggplot2)
#transpose OTU table
otu_table_t<-t(otu_table)
#calculate a PCoA plot, unrarefied data
s16.pcoa<-capscale(otu_table_t ~ 1, distance='bray')
100*round(s16.pcoa$CA$eig[1]/sum(s16.pcoa$CA$eig), 3)
#10.8
100*round(s16.pcoa$CA$eig[2]/sum(s16.pcoa$CA$eig), 3)
#7.9
#extract the coordinates
s16.scores<-scores(s16.pcoa)
s16.coords<-as.data.frame(s16.scores$sites)
s16.coords$SampleID<-rownames(s16.coords)
s16.coords<-merge(s16.coords, meta, by=c('SampleID'))
#plot it yo
ggplot(s16.coords, aes(MDS1, MDS2, colour=Species, shape=Nuc_type))+
geom_point(aes(size=2))+
theme_bw()+
xlab("PC1-26.3%")+
ylab("PC2-13.7%")+
theme(text = element_text(size=14),
axis.text = element_text(size=14), legend.text=element_text(size=14))
bates_metag_comparison <- read.delim("C:/Users/patty/OneDrive/Desktop/bates_metag_comparison.txt")
View(bates_metag_comparison)
library(ggplot2)
library(dplyr)
library(reshape2)
#reshape data
bates_m<-melt(bates_metag_comparison)
View(bates_M)
View(bates_m)
bates_m$Sample<-bates_m$variable
?separate
library(tidyr)
bates_m<-separate(bates_m, col=Sample, into=c("16S", "metaG", sep='_')
)
View(bates_m
)
unique(bates_m$metaG)
?gsub
bates_m$metaG<-gsub("NA", "16S", bates_m$metaG)
unique(bates_m$metaG)
#read in data
bates_metag_comparison <- read.delim("C:/Users/patty/OneDrive/Desktop/bates_metag_comparison.txt")
#load packages
library(ggplot2)
library(dplyr)
library(tidyr)
library(reshape2)
#reshape data
bates_m<-melt(bates_metag_comparison)
bates_m$Sample<-bates_m$variable
bates_m<-separate(bates_m, col=Sample, into=c("SampleID", "Type", sep='_'))
View(bates_m)
unique(bates_m$Type)
unique(bates_m$SampleID)
?cor.test
bates_corr<-ddply(bates_m, c("SampleID", "Type"), summarize, cor.test(value))
library(plyr)
#calculate correlations
bates_corr<-ddply(bates_m, c("SampleID", "Type"), summarize, cor.test(value))
#calculate correlations
bates_corr<-ddply(bates_m, c("SampleID", "Type"), summarize, cor.test(value,value))
View(bates_corr)
bates_split<-split(bates_m, bates_m$Type)
bates_split<-split(bates_m, bates_m$SampleID)
?cor
?cast
View(bates_m)
test<-cast(bates_m, Type)
test<-dcast(bates_m, Type)
test<-dcast(bates_m, ~Type)
test<-dcast(bates_m, bates_m$Type)
test<-dcast(bates_m, value ~ Type)
View(test)
test<-dcast(bates_m, value ~ Type + SampleID)
View(test)
bates_m$function.
test<-dcast(bates_m, value ~ Type + function.)
test<-dcast(bates_m, value ~ Type ~ function.)
test<-dcast(bates_m, value ~ Type + function.)
test<-dcast(bates_m, value ~ Type)
View(test)
test<-dcast(bates_m, SampleID ~ Type)
View(test)
ggplot(test, aes(16S, m))+
ggplot(test, aes('16S', m))+
geom_point()+
facet_wrap(~SampleID)
dim(test)
test<-dcast(bates_m, SampleID ~ Type ~value.)
bates_m<-bates_m[,c(1,3:5)]
View(bates_m)
test<-dcast(bates_m, SampleID ~ Type)
View(test)
test<-dcast(bates_m, function. ~ SampleID ~ Type)
test<-dcast(bates_m, function. ~ SampleID, Type)
test<-dcast(bates_m, function. ~ SampleID)
View(test)
test<-cast(bates_m, function. ~ SampleID)
bates_split<-split(bates_m, bates_m$SampleID)
bates_split$S1
bates_split<-split(bates_m, bates_m$Type)
bates_split
View(bates_split$16S)
View(bates_split$16S)
View(bates_split$16S)
View(bates_split$m)
bates_m<-cbind(bates_split$16S, bates_split$m)
bates_metag_comparison <- read.delim("C:/Users/patty/OneDrive/Desktop/bates_metag_comparison.txt")
#load packages
library(ggplot2)
library(dplyr)
library(plyr)
library(tidyr)
library(reshape2)
#reshape data
bates_m<-melt(bates_metag_comparison)
bates_m$Sample<-bates_m$variable
bates_m<-separate(bates_m, col=Sample, into=c("SampleID", "Type", sep='_'))
bates_m<-bates_m[,c(1,3:5)]
bates_split<-split(bates_m, bates_m$Type)
bates_m<-cbind(bates_split$S16, bates_split$m)
View(bates_m)
names(bates_m)<-c("KO", "S16_abun", "SampleID", "Type1", "KO2", "M_abun", "SampleID2", "Type2")
func <- function(xx)
{
return(data.frame(COR = cor(xx$S16_abun, xx$M_abun)))
}
ddply(xx, .(SampleID), func)
ddply(bates_m, .(SampleID), func)
?cor
func <- function(xx)
{
return(data.frame(COR = cor(xx$S16_abun, xx$M_abun, method='spearman')))
}
ddply(bates_m, .(SampleID), func)
bates_corr<-ddply(bates_m, .(SampleID), func)
?cor.test
return(data.frame(COR = cor.test(xx$S16_abun, xx$M_abun, method='spearman')))
func <- function(xx)
{
return(data.frame(COR = cor.test(xx$S16_abun, xx$M_abun, method='spearman')))
}
bates_corr<-ddply(bates_m, .(SampleID), func)
ddply(bates_m, .(SampleID), func)
func <- function(xx)
{
return(data.frame(COR = cor(xx$S16_abun, xx$M_abun, method='spearman')))
}
bates_corr<-ddply(bates_m, .(SampleID), func)
hist(bates_corr$COR)
boxplot(bates_corr$COR)
ggplot(bates_m, aes(S16_abun, M_abun))+
geom_point()+
geom_smooth(stat='lm')+
theme_bw()
?geom_smooth
ggplot(bates_m, aes(S16_abun, M_abun))+
geom_point()+
geom_smooth(method='lm')+
theme_bw()
ggplot(bates_m, aes(S16_abun, M_abun, color=SampleID))+
geom_point()+
geom_smooth(method='lm')+
theme_bw()+
xlab("KO Abundance- 16S rRNA gene")+
ylab("KO Abundance- Shotgun Metagenome")
ggplot(bates_m, aes(S16_abun, M_abun, color=SampleID))+
geom_point()+
geom_smooth(method='lm')+
facet_wrap(~SampleID, scales='free')+
theme_bw()+
xlab("KO Abundance- 16S rRNA gene")+
ylab("KO Abundance- Shotgun Metagenome")
boxplot(bates_corr, ylim=c(0,100))
boxplot(bates_corr$COR, ylim=c(0,100))
boxplot(bates_corr$COR, ylim=c(0,1))
